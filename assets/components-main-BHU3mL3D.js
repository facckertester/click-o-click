var ve=Object.defineProperty,we=Object.defineProperties;var je=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var ae=(e,l,a)=>l in e?ve(e,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[l]=a,m=(e,l)=>{for(var a in l||(l={}))ke.call(l,a)&&ae(e,a,l[a]);if(le)for(var a of le(l))Ce.call(l,a)&&ae(e,a,l[a]);return e},X=(e,l)=>we(e,je(l));import{r as N,j as o,R as ce}from"./vendor-react-CUeQczFW.js";import{t,f as p,W as Te,h as Be,g as D,P as H,B as _,a as Me}from"./core-xOYQ6Dy5.js";import{a as de}from"./components-ui-BlRqXoiM.js";const Re=({message:e,type:l,x:a,y,onComplete:v})=>{const[B,j]=N.useState(!0);N.useEffect(()=>{const V=setTimeout(()=>{j(!1),setTimeout(v,300)},2e3);return()=>clearTimeout(V)},[v]);const O=()=>{switch(l){case"gold":return{background:"#fff3e0",border:"2px solid #ffa726",color:"#e65100"};case"win":return{background:"#e8f5e8",border:"2px solid #66bb6a",color:"#2e7d32"};case"lose":return{background:"#ffebee",border:"2px solid #ef5350",color:"#c62828"};case"damage":return{background:"#fff3e0",border:"2px solid #ff9800",color:"#e65100"};case"reward":return{background:"#e3f2fd",border:"2px solid #42a5f5",color:"#1565c0"};default:return{background:"#f5f5f5",border:"2px solid #9e9e9e",color:"#424242"}}},U=()=>{switch(l){case"gold":return"ðŸ’°";case"win":return"ðŸŽ‰";case"lose":return"ðŸ˜¢";case"damage":return"âš”ï¸";case"reward":return"ðŸ†";default:return"â„¹ï¸"}};return B?o.jsxs("div",{className:`floating-message ${B?"visible":"hidden"}`,style:X(m({position:"fixed",left:`${a}px`,top:`${y}px`},O()),{zIndex:9999,padding:"8px 12px",borderRadius:"8px",fontSize:"14px",fontWeight:"bold",boxShadow:"2px 2px 8px rgba(0,0,0,0.3)",animation:"floatUp 2s ease-out forwards",transform:"translateX(-50%)",whiteSpace:"nowrap",pointerEvents:"none"}),children:[o.jsx("span",{style:{marginRight:"5px"},children:U()}),e]}):null},ze=ce.memo(({renown:e,totalRenownEarned:l,numberFormat:a,currentTheme:y})=>{const v=de(l).minus(t(1)).times(t(100)).floor().toNumber();if(v<=0)return null;const j=(()=>{if(y==="default"||!y)return{background:"rgba(103, 58, 183, 0.6)",border:"2px solid rgba(103, 58, 183, 0.9)",text:"#311b92",textShadow:"0 0 8px rgba(49, 27, 146, 0.8)"};switch(y){case"dark":return{background:"rgba(103, 58, 183, 0.2)",border:"1px solid rgba(103, 58, 183, 0.6)",text:"#9575cd",textShadow:"0 0 8px rgba(149, 117, 205, 0.4)"};case"midnight":return{background:"rgba(103, 58, 183, 0.2)",border:"1px solid rgba(103, 58, 183, 0.6)",text:"#9575cd",textShadow:"0 0 8px rgba(149, 117, 205, 0.4)"};default:return{background:"rgba(103, 58, 183, 0.6)",border:"2px solid rgba(103, 58, 183, 0.9)",text:"#311b92",textShadow:"0 0 8px rgba(49, 27, 146, 0.8)"}}})();return o.jsx("div",{style:{padding:"5px 15px",background:j.background,border:j.border,borderRadius:"20px",display:"inline-block",cursor:"help"},"data-tooltip":`Total Renown: ${p(l,a)}
Bonus: +${v}% to all income
Renown is earned by prestiging and provides permanent bonuses`,children:o.jsxs("span",{style:{color:j.text,fontWeight:"bold",textShadow:j.textShadow,fontSize:"0.9rem",lineHeight:"1.2",display:"inline-block"},children:[o.jsxs("span",{className:"badge-compact-text",style:{display:"inline-block"},children:["ðŸ‘‘ +",v,"%"]}),o.jsxs("span",{className:"badge-full-text",style:{display:"none"},children:["ðŸ‘‘ Total Renown: ",p(l,a)," +",v,"%"]})]})})}),We=ce.memo(({gameState:e,gps:l,onClick:a,onEventInteract:y,onOpenTavern:v,onOpenPrestige:B,onOpenSettings:j,onOpenStatistics:O,onOpenLeaderboard:U,onOpenEmpire:V,isIdle:c})=>{var Z,S,ee;const[pe,Y]=N.useState([]),[ue,q]=N.useState([]),Q=N.useRef(null),F=e.interface||{showFloatingText:!0,showWeatherWidget:!0,crownAnimations:!0},W=()=>{let n=0;return e.nationalProjects&&Object.values(e.nationalProjects).forEach(i=>{n+=i.level*H}),t(n)},A=(n,i,s,k)=>{const C=Date.now()+Math.random();q(G=>[...G,{id:C,message:n,type:i,x:s,y:k}])},xe=n=>{q(i=>i.filter(s=>s.id!==n))},be=n=>{var i,s,k;if(F.showFloatingText){const C=(i=Q.current)==null?void 0:i.getBoundingClientRect();if(C){const G=n.clientX-C.left+(Math.random()*40-20),K=n.clientY-C.top+(Math.random()*40-20),R=t(1),te=e.clickUpgradeLevel||0,ge=Math.min(te,15),me=t(2).pow(ge),oe=R.times(me),f=de(e.totalRenownEarned);let g=oe;f.gt(t(1))&&(g=oe.times(f));const re=Me(te);if(re>0){let u=t(0);_.forEach(r=>{const h=e.buildings[r.id]||t(0);h.gt(0)&&(u=u.plus(h.times(r.baseProduction)))});let x=u;f.gt(t(1))&&(x=u.times(f));let z=0;e.nationalProjects&&Object.values(e.nationalProjects).forEach(r=>z+=r.level||0);const T=t(1).plus(t(z*H));x=x.times(T);const w=((s=e.weather)==null?void 0:s.current)||"clear";let b=t(0);_.forEach(r=>{const h=e.buildings[r.id]||t(0);if(h.gt(0)){let d=t(1);w==="sunny"?(r.id==="peasant"||r.id==="field"||r.id==="stable"||r.id==="cathedral")&&(d=t(1.2)):w==="rainy"?(r.id==="silver_mine"||r.id==="alchemist"||r.id==="market"||r.id==="tavern")&&(d=t(1.2)):w==="stormy"?((r.id==="blacksmith"||r.id==="void_portal")&&(d=t(1.3)),(r.id==="field"||r.id==="stable")&&(d=t(.8))):w==="windy"&&(r.id==="market"||r.id==="castle"||r.id==="time_chamber")&&(d=t(1.15));const P=h.times(r.baseProduction);f.gt(t(1))?b=b.plus(P.times(f).times(T).times(d.minus(t(1)))):b=b.plus(P.times(T).times(d.minus(t(1))))}});const se=x.plus(b),L=t(1).plus(t(e.achievements.length*.02)),E=se.times(L);let I=E;e.globalIncomeMultiplier&&(I=E.times(t(e.globalIncomeMultiplier))),g=g.plus(I.times(re))}const ne=t(1).plus(t(e.achievements.length*.02));if(g=g.times(ne),e.globalIncomeMultiplier&&(g=g.times(t(e.globalIncomeMultiplier))),e.godMode){let u=t(0);_.forEach(r=>{const h=e.buildings[r.id]||t(0);h.gt(0)&&(u=u.plus(h.times(r.baseProduction)))});let x=u;f.gt(t(1))&&(x=u.times(f));let z=0;e.nationalProjects&&Object.values(e.nationalProjects).forEach(r=>z+=r.level||0);const T=t(1).plus(t(z*H));x=x.times(T);const w=((k=e.weather)==null?void 0:k.current)||"clear";let b=t(0);_.forEach(r=>{const h=e.buildings[r.id]||t(0);if(h.gt(0)){let d=t(1);w==="sunny"?(r.id==="peasant"||r.id==="field"||r.id==="stable"||r.id==="cathedral")&&(d=t(1.2)):w==="rainy"?(r.id==="silver_mine"||r.id==="alchemist"||r.id==="market"||r.id==="tavern")&&(d=t(1.2)):w==="stormy"?((r.id==="blacksmith"||r.id==="void_portal")&&(d=t(1.3)),(r.id==="field"||r.id==="stable")&&(d=t(.8))):w==="windy"&&(r.id==="market"||r.id==="castle"||r.id==="time_chamber")&&(d=t(1.15));const P=h.times(r.baseProduction);f.gt(t(1))?b=b.plus(P.times(f).times(T).times(d.minus(t(1)))):b=b.plus(P.times(T).times(d.minus(t(1))))}});const L=x.plus(b).times(ne);let E=L;e.globalIncomeMultiplier&&(E=L.times(t(e.globalIncomeMultiplier)));const I=E.times(t(99999));g=g.plus(I)}const ye="+"+p(g,e.numberFormat),ie={id:Date.now(),x:G,y:K,val:ye};Y(u=>[...u,ie]),setTimeout(()=>{Y(u=>u.filter(x=>x.id!==ie.id))},1e3)}}a(n)},M=Te[((Z=e.weather)==null?void 0:Z.current)||"clear"],$={transition:"transform 0.8s ease-in-out, width 0.8s ease-in-out, height 0.8s ease-in-out, margin 0.8s ease-in-out, position 0.8s ease-in-out"},he=m(c?{position:"fixed",bottom:"120px",right:"30px",transform:"scale(0.8)",transformOrigin:"bottom right",textAlign:"right",zIndex:100}:{transform:"scale(1)",marginBottom:"3rem",zIndex:10,textAlign:"center"},$),fe=m(c?{width:"80px",height:"80px",fontSize:"2rem",position:"fixed",bottom:"30px",right:"30px",borderRadius:"50%",zIndex:100}:{width:"260px",height:"260px",fontSize:"6rem",borderRadius:"50%",position:"relative",zIndex:5,margin:"0 auto"},$),J={opacity:c?0:1,transition:"opacity 0.5s ease-in-out",pointerEvents:c?"none":"auto"};return o.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",padding:"var(--panel-padding)",height:"100%",overflow:"hidden"},children:[F.showWeatherWidget&&o.jsxs("div",{style:m({position:"absolute",top:"10px",left:"10px",zIndex:20,background:M.color,padding:"8px 12px",borderRadius:"20px",border:"2px solid rgba(0,0,0,0.1)",boxShadow:"2px 2px 5px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:"8px",cursor:"help"},J),"data-tooltip":`${M.name}: ${M.description}`,children:[o.jsx("span",{style:{fontSize:"1.5rem"},children:M.icon}),o.jsxs("div",{style:{textAlign:"left",lineHeight:"1.1"},children:[o.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem",color:"#222"},children:M.name}),o.jsxs("div",{style:{fontSize:"0.7rem",color:"#444"},children:[t(Number(((S=e.weather)==null?void 0:S.timeLeft)||0)).ceil().toString(),"s remaining"]})]})]}),o.jsxs("div",{style:m({position:"absolute",top:"10px",right:"10px",zIndex:20,display:"flex",gap:"5px"},J),children:[o.jsx("button",{onClick:U,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.8,color:"var(--text-color)",transition:"all 0.2s ease"},title:"Leaderboard (Available for all players)",children:"ðŸ†"}),o.jsx("button",{onClick:O,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.7,color:"var(--text-color)"},title:"Statistics",children:"ðŸ“Š"}),o.jsx("button",{onClick:j,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.7,color:"var(--text-color)"},title:"Kingdom Settings",children:"âš™ï¸"})]}),o.jsxs("div",{style:he,children:[o.jsx("div",{style:{fontSize:"1rem",color:c?"var(--text-color)":"var(--text-secondary)",marginBottom:"5px",textTransform:"uppercase",letterSpacing:"2px",textShadow:c?"1px 1px 2px #000":"none"},children:"Royal Treasury"}),o.jsx("div",{style:{fontSize:"3rem",fontFamily:"var(--font-main)",color:"var(--text-color)",textShadow:c?"2px 2px 4px #000":"2px 2px 0px rgba(255, 215, 0, 0.4)"},children:p(e.gold,e.numberFormat)}),o.jsxs("div",{style:{marginTop:"5px",fontSize:"1.1rem",color:c?"#90ee90":"var(--success-color)",fontStyle:"italic",textShadow:c?"1px 1px 2px #000":"none"},children:["+",p(l,e.numberFormat)," gold / sec"]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",marginTop:"15px"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",justifyContent:"center"},children:[o.jsx(ze,{renown:e.renown,totalRenownEarned:e.totalRenownEarned,numberFormat:e.numberFormat,currentTheme:e.theme}),Be(e.totalGold)&&(()=>{if(D(e.infiniteTowerLevel||0).minus(t(1)).times(t(100)).floor().toNumber()<=0)return null;const s=(()=>{if(e.theme==="default"||!e.theme)return{background:"rgba(103, 58, 183, 0.6)",border:"2px solid rgba(103, 58, 183, 0.9)",text:"#7b1fa2",textShadow:"0 0 8px rgba(123, 31, 162, 0.8)"};switch(e.theme){case"dark":return{background:"rgba(103, 58, 183, 0.2)",border:"1px solid rgba(103, 58, 183, 0.6)",text:"#ba68c8",textShadow:"0 0 8px rgba(186, 104, 200, 0.4)"};case"midnight":return{background:"rgba(103, 58, 183, 0.2)",border:"1px solid rgba(103, 58, 183, 0.6)",text:"#ba68c8",textShadow:"0 0 8px rgba(186, 104, 200, 0.4)"};default:return{background:"rgba(103, 58, 183, 0.6)",border:"2px solid rgba(103, 58, 183, 0.9)",text:"#7b1fa2",textShadow:"0 0 8px rgba(123, 31, 162, 0.8)"}}})();return o.jsx("div",{style:{padding:"5px 15px",background:s.background,border:s.border,borderRadius:"20px",display:"inline-block",cursor:"help"},"data-tooltip":`Infinite Tower Level: ${e.infiniteTowerLevel||0}
Bonus: +${p(D(e.infiniteTowerLevel||0).minus(t(1)).times(t(100)),e.numberFormat)}% to all income
Each tower floor provides +100% bonus
Build floors using Dark Matter Gold`,children:o.jsxs("span",{style:{color:s.text,fontWeight:"bold",textShadow:s.textShadow,fontSize:"0.9rem",lineHeight:"1.2",display:"inline-block"},children:[o.jsxs("span",{className:"badge-compact-text",style:{display:"inline-block"},children:["ðŸ—ï¸ +",p(D(e.infiniteTowerLevel||0).minus(t(1)).times(t(100)),e.numberFormat),"%"]}),o.jsxs("span",{className:"badge-full-text",style:{display:"none"},children:["ðŸ—ï¸ Tower: +",p(D(e.infiniteTowerLevel||0).minus(t(1)).times(t(100)),e.numberFormat),"%"]})]})})})()]}),o.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",justifyContent:"center"},children:[(()=>{if(W().times(t(100)).floor().toNumber()<=0)return null;const s=(()=>{if(e.theme==="default"||!e.theme)return{background:"rgba(76, 175, 80, 0.6)",border:"2px solid rgba(76, 175, 80, 0.9)",text:"#1b5e20",textShadow:"0 0 8px rgba(27, 94, 32, 0.8)"};switch(e.theme){case"dark":return{background:"rgba(76, 175, 80, 0.2)",border:"1px solid rgba(76, 175, 80, 0.6)",text:"#81c784",textShadow:"0 0 8px rgba(129, 199, 132, 0.4)"};case"midnight":return{background:"rgba(76, 175, 80, 0.2)",border:"1px solid rgba(76, 175, 80, 0.6)",text:"#81c784",textShadow:"0 0 8px rgba(129, 199, 132, 0.4)"};default:return{background:"rgba(76, 175, 80, 0.6)",border:"2px solid rgba(76, 175, 80, 0.9)",text:"#1b5e20",textShadow:"0 0 8px rgba(27, 94, 32, 0.8)"}}})();return o.jsx("div",{style:{padding:"5px 15px",background:s.background,border:s.border,borderRadius:"20px",display:"inline-block",cursor:"help"},"data-tooltip":`National Projects Bonus: +${p(W().times(t(100)),e.numberFormat)}%
Each project level provides +${H*100}% bonus
Build projects in the Empire menu
Projects enhance all building production`,children:o.jsxs("span",{style:{color:s.text,fontWeight:"bold",textShadow:s.textShadow,fontSize:"0.9rem",lineHeight:"1.2",display:"inline-block"},children:[o.jsxs("span",{className:"badge-compact-text",style:{display:"inline-block"},children:["ðŸ—ï¸ +",p(W().times(t(100)),e.numberFormat),"%"]}),o.jsxs("span",{className:"badge-full-text",style:{display:"none"},children:["ðŸ—ï¸ Projects: +",p(W().times(t(100)),e.numberFormat),"%"]})]})})})(),(()=>{const n=e.achievements.length*2;if(n<=0)return null;const s=(()=>{if(e.theme==="default"||!e.theme)return{background:"rgba(255, 152, 0, 0.6)",border:"2px solid rgba(255, 152, 0, 0.9)",text:"#bf360c",textShadow:"0 0 8px rgba(191, 54, 12, 0.8)"};switch(e.theme){case"dark":return{background:"rgba(255, 152, 0, 0.25)",border:"1px solid rgba(255, 152, 0, 0.7)",text:"#ffb74d",textShadow:"0 0 8px rgba(255, 183, 77, 0.4)"};case"midnight":return{background:"rgba(255, 152, 0, 0.25)",border:"1px solid rgba(255, 152, 0, 0.7)",text:"#ffb74d",textShadow:"0 0 8px rgba(255, 183, 77, 0.4)"};default:return{background:"rgba(255, 152, 0, 0.6)",border:"2px solid rgba(255, 152, 0, 0.9)",text:"#bf360c",textShadow:"0 0 8px rgba(191, 54, 12, 0.8)"}}})();return o.jsx("div",{style:{padding:"5px 15px",background:s.background,border:s.border,borderRadius:"20px",display:"inline-block",cursor:"help"},"data-tooltip":`Achievements Bonus: +${n}%
Achievements: ${e.achievements.length} unlocked
Each achievement provides +2% bonus
Complete various challenges to earn achievements
Achievements give permanent income bonuses`,children:o.jsxs("span",{style:{color:s.text,fontWeight:"bold",textShadow:s.textShadow,fontSize:"0.9rem",lineHeight:"1.2",display:"inline-block"},children:[o.jsxs("span",{className:"badge-compact-text",style:{display:"inline-block"},children:["ðŸ† +",n,"%"]}),o.jsxs("span",{className:"badge-full-text",style:{display:"none"},children:["ðŸ† Achievements: +",n,"%"]})]})})})()]})]})]}),o.jsxs("div",{style:{position:"relative",marginBottom:c?0:"3rem",display:"flex",justifyContent:"center",alignItems:"center"},children:[o.jsx("div",{className:"magnetic-container",children:o.jsx("button",{ref:Q,className:`main-button ${c?"idle":""} ${F.crownAnimations?"":"no-animations"}`,style:X(m({},fe),{display:"flex",alignItems:"center",justifyContent:"center",outline:"none",color:"#5d4037",cursor:"pointer",overflow:"hidden"}),onClick:be,children:o.jsx("span",{className:F.crownAnimations?"crown-icon":"",style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",lineHeight:1,marginTop:"-10px"},children:"ðŸ‘‘"})})}),!c&&pe.map(n=>o.jsx("div",{className:"floating-text",style:{left:n.x,top:n.y},children:n.val},n.id))]}),o.jsxs("div",{style:m({display:"flex",gap:"10px",zIndex:10,flexWrap:"wrap",justifyContent:"center"},J),children:[e.buildings.field&&e.buildings.field.gt(t(0))&&o.jsx("button",{className:"btn",style:{background:"var(--accent-color)",borderColor:"var(--gold-color)"},onClick:V,children:"ðŸ—ï¸ Projects"}),((ee=e.buildings.tavern)==null?void 0:ee.gt(t(0)))&&o.jsx("button",{className:"btn",onClick:v,children:"ðŸº Tavern"}),(e.totalGold.gt(t(5e5))||e.renown.gt(t(0)))&&o.jsx("button",{className:"btn",style:{background:"var(--accent-color)"},onClick:B,children:"ðŸ‘‘ Legacy"})]}),!c&&e.event&&e.event.type==="dragon"&&o.jsx("div",{className:"dragon-event",onMouseDown:n=>{try{if(!e.event)return;const i=n.currentTarget.getBoundingClientRect(),s=t(e.event.hp||10),k=t(e.event.maxHp||10),C=s.lte(t(1)),K=(l||t(1)).times(t(30));if(C)try{A(`+${p(K.floor(),e.numberFormat)} gold!`,"reward",i.left+i.width/2,i.top)}catch(R){console.error("Error adding floating message:",R)}else try{A(`-${p(t(1),e.numberFormat)} HP`,"damage",i.left+i.width/2,i.top)}catch(R){console.error("Error adding floating message:",R)}y(e.event)}catch(i){console.error("Error clicking dragon:",i)}},children:"ðŸ‰"}),!c&&e.event&&e.event.type==="merchant"&&o.jsxs("div",{style:{position:"absolute",right:"20px",top:"100px",background:"#fff3e0",padding:"10px",border:"2px solid orange",zIndex:100,cursor:"pointer",animation:"pop 0.5s",borderRadius:"8px",boxShadow:"2px 2px 5px rgba(0,0,0,0.2)"},onClick:n=>{const i=n.currentTarget.getBoundingClientRect(),s=l.times(t(10));A(`+${p(s.floor(),e.numberFormat)} gold`,"gold",i.left+i.width/2,i.top),y(e.event)},children:[o.jsx("div",{style:{fontSize:"1.5rem",textAlign:"center"},children:"ðŸ‘³"}),o.jsx("div",{style:{fontWeight:"bold",color:"#000"},children:"Merchant"}),o.jsx("small",{style:{color:"#444"},children:"Click for gift"})]}),!c&&e.event&&e.event.type==="jester"&&o.jsxs("div",{style:{position:"absolute",left:"20px",top:"100px",background:"#fce4ec",padding:"10px",border:"2px solid pink",zIndex:100,cursor:"pointer",animation:"pop 0.5s",borderRadius:"8px",boxShadow:"2px 2px 5px rgba(0,0,0,0.2)"},onClick:n=>{const i=n.currentTarget.getBoundingClientRect(),s=e.gold.times(t(.1)),k=Math.random()>.5;A(`${k?"+":"-"}${p(s.floor(),e.numberFormat)} gold`,k?"win":"lose",i.left+i.width/2,i.top),y(e.event)},children:[o.jsx("div",{style:{fontSize:"1.5rem",textAlign:"center"},children:"ðŸ¤¡"}),o.jsx("div",{style:{fontWeight:"bold",color:"#000"},children:"Jester"}),o.jsx("small",{style:{color:"#444"},children:"Risk it all?"})]}),ue.map(n=>o.jsx(Re,{message:n.message,type:n.type,x:n.x,y:n.y,onComplete:()=>xe(n.id)},n.id))]})});export{We as M};
